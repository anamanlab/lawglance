# Known Issues Register

Last updated: 2026-02-25
Owner: platform-engineering

Use this file as the canonical issue tracker when GitHub Issues are disabled for the repository.

## Open Issues

| ID | Severity | Area | Summary | Owner | Target |
|---|---|---|---|---|---|
| KI-2026-02-25-01 | P0 | platform-migration | Cloudflare frontend and edge proxy are live, but backend is still on transitional origin path (Cloudflare proxy -> legacy backend origin). Full Cloudflare-native backend runtime plus canary validation is still required before migration completion; native Python Worker path is currently blocked by bundle-size limits (see KI-2026-02-25-09). | platform | Immediate |
| KI-2026-02-25-09 | P0 | platform-limits | Native Python Worker deploy is currently blocked by Cloudflare plan bundle-size limits: measured dry-run package size is `27042.96 KiB` total / `5973.60 KiB` gzip and deploy fails with API `code: 10027` (`3 MiB` free-plan Worker size limit, `10 MiB` paid-plan limit). Largest bundled modules include `pydantic_core` and `cryptography`, making current native build non-viable on free tier without major dependency/runtime changes. | platform | Immediate |
| KI-2026-02-25-10 | P1 | capacity-limits | Free-plan runtime quotas (`100,000` requests/day, `1,000` req/min burst, `10 ms` CPU per request, `50` subrequests/request) remain an operational risk for production traffic. Quota-aware alerting is now implemented (projected API request/day warn/fail thresholds in ops alerts), but traffic controls and Cloudflare-native CPU/subrequest telemetry coverage are still pending for Worker-invoking routes. | platform | Before Phase 5 cutover |
| KI-2026-02-25-11 | P1 | backend-origin-rollout | Current backend origin deployment behind the Cloudflare proxy is missing `POST /api/research/lawyer-cases` and returns JSON `404 {\"detail\":\"Not Found\"}`. Frontend proxy now mitigates this by mapping that upstream 404 to a structured `503 SOURCE_UNAVAILABLE`, but backend-origin rollout is still required to restore full lawyer-research functionality. | platform | Immediate |
| KI-2026-02-25-04 | P1 | operations | Repository-level issue tracking is disabled in GitHub, increasing risk that production defects are not centrally triaged unless this register is actively maintained. | eng-ops | Immediate |
| KI-2026-02-25-07 | P1 | backend-runtime | Python Workers compatibility baseline and perf-smoke harness are now in place, but heavy backend internals still execute synchronous I/O paths. Before full Cloudflare-native production cutover we still need production-grade load/perf validation and, if required, async refactors for hot paths. | platform | Before Phase 3 cutover |
| KI-2026-02-25-08 | P2 | dns-operations | Custom domain propagation can lag on some local resolvers during cutover windows. Release checks must validate DNS via authoritative/public resolvers before declaring endpoint outage. | platform | During next deploy window |

## Recently Closed

| ID | Closed Date | Summary | Evidence |
|---|---|---|---|
| KI-2026-02-25-C25 | 2026-02-25 | Frontend Cloudflare proxy now gracefully handles missing upstream lawyer-research route by mapping upstream `404` responses for `/api/research/lawyer-cases` to a structured `503 SOURCE_UNAVAILABLE` contract error, preventing raw backend `404` leakage during transitional backend-origin rollout. Redeployed frontend Worker and verified both `workers.dev` and custom-domain live responses. | `frontend-web/lib/backend-proxy.ts`, `frontend-web/tests/backend-proxy.contract.test.ts`, frontend deploy version `30029410-c9b3-41d9-b452-e4dc67f9b596`, live POST smoke checks on `https://immcad-frontend-web.optivoo-edu.workers.dev/api/research/lawyer-cases` and `https://immcad.arkiteto.dpdns.org/api/research/lawyer-cases` |
| KI-2026-02-25-C26 | 2026-02-25 | Added deterministic Cloudflare edge-contract preflight guardrails across local release preflight, CI quality/release gates, and backend-proxy deploy workflow; success proxy responses now also emit `x-trace-id` for complete trace-header continuity. | `scripts/check_cloudflare_edge_proxy_contract.sh`, `scripts/release_preflight.sh`, `Makefile`, `.github/workflows/quality-gates.yml`, `.github/workflows/release-gates.yml`, `.github/workflows/cloudflare-backend-proxy-deploy.yml`, `backend-cloudflare/src/worker.ts`, `tests/test_cloudflare_edge_proxy_contract_script.py`, `tests/test_release_preflight_script.py`, `tests/test_cloudflare_backend_proxy_deploy_workflow.py`, `tests/test_quality_gates_workflow.py`, `tests/test_release_gates_workflow.py` |
| KI-2026-02-25-C24 | 2026-02-25 | Added Cloudflare free-tier quota projection alerts to ops evaluation and release runbook using derived request-rate metrics (warn/fail thresholds for projected API requests/day against the free-plan limit). | `src/immcad_api/ops/alert_evaluator.py`, `backend-vercel/src/immcad_api/ops/alert_evaluator.py`, `config/ops_alert_thresholds.json`, `tests/test_ops_alert_evaluator.py`, `docs/release/pre-deploy-command-sheet-2026-02-25.md` |
| KI-2026-02-25-C23 | 2026-02-25 | Added free-plan blocker guardrails and proxy resiliency controls: Cloudflare proxy deploy workflow now enforces free-plan dry-run size checks before deploy, release preflight includes the same guard, and edge proxy behavior now includes bounded timeout/retry and traceable upstream error envelopes. Deployed backend proxy mitigation to Cloudflare (`1499a8af-54f0-451e-a0ac-a39f7cf9e935`, `2026-02-25T22:56:56Z`) and verified live proxy headers/error envelope on custom domain. | `scripts/check_cloudflare_free_plan_readiness.sh`, `scripts/release_preflight.sh`, `Makefile` (`cloudflare-free-preflight`), `.github/workflows/cloudflare-backend-proxy-deploy.yml`, `backend-cloudflare/src/worker.ts`, `docs/release/pre-deploy-command-sheet-2026-02-25.md`, `tests/test_cloudflare_free_plan_readiness_script.py`, `tests/test_cloudflare_backend_proxy_deploy_workflow.py`, `tests/test_cloudflare_backend_migration_artifacts.py`, backend proxy version `1499a8af-54f0-451e-a0ac-a39f7cf9e935`, smoke checks on `https://immcad-api.arkiteto.dpdns.org` |
| KI-2026-02-25-C22 | 2026-02-25 | Added repeatable Cloudflare backend performance smoke harness and release-runbook integration to capture authenticated latency evidence (request count, concurrency, p50/p95 threshold checks). | `scripts/run_cloudflare_backend_perf_smoke.sh`, `Makefile` (`backend-cf-perf-smoke`), `docs/release/pre-deploy-command-sheet-2026-02-25.md`, `docs/development-environment.md` |
| KI-2026-02-25-C21 | 2026-02-25 | Added Cloudflare native backend runtime scaffold (Python Workers path) with dedicated entrypoint/config/toolchain and deploy workflow contract tests. | `backend-cloudflare/src/entry.py`, `backend-cloudflare/wrangler.toml`, `backend-cloudflare/pyproject.toml`, `.github/workflows/cloudflare-backend-native-deploy.yml`, `tests/test_cloudflare_backend_native_deploy_workflow.py`, `tests/test_cloudflare_backend_migration_artifacts.py` |
| KI-2026-02-25-C20 | 2026-02-25 | Documentation drift closure for Cloudflare migration: release command sheet, readiness audit, migration plan status banners, and secret/onboarding/development docs now align with Cloudflare-first deployment and explicitly mark Vercel-only flows as transitional/historical. | `docs/release/pre-deploy-command-sheet-2026-02-25.md`, `docs/release/lead-engineering-readiness-audit-2026-02-25.md`, `docs/plans/2026-02-25-production-finalization-go-live-plan.md`, `docs/plans/2026-02-25-pre-deploy-deep-audit-plan.md`, `docs/plans/2026-02-25-deep-production-readiness-audit-plan.md`, `docs/plans/2026-02-25-cloudflare-migration-plan.md`, `docs/release/git-secret-runbook.md`, `docs/development-environment.md`, `docs/onboarding/developer-onboarding-guide.md` |
| KI-2026-02-25-C19 | 2026-02-25 | Release process control hardened with deterministic clean-worktree preflight guard before deploy execution. | `scripts/release_preflight.sh`, `Makefile` (`release-preflight`), `docs/release/pre-deploy-command-sheet-2026-02-25.md` |
| KI-2026-02-25-C18 | 2026-02-25 | Lawyer-focused case research pipeline is now production-wired end-to-end: dedicated backend route (`/api/research/lawyer-cases`), structured relevance + PDF/export status per case, frontend panel integration, and observability metrics for lawyer-research outcomes. | `src/immcad_api/services/lawyer_research_planner.py`, `src/immcad_api/services/lawyer_case_research_service.py`, `src/immcad_api/services/case_document_resolver.py`, `src/immcad_api/api/routes/lawyer_research.py`, `src/immcad_api/main.py`, `src/immcad_api/telemetry/request_metrics.py`, `frontend-web/components/chat/chat-shell-container.tsx`, `frontend-web/components/chat/related-case-panel.tsx`, `frontend-web/app/api/research/lawyer-cases/route.ts`, `tests/test_lawyer_research_api.py`, `tests/test_lawyer_case_research_service.py`, `tests/test_case_document_resolver.py`, `tests/test_request_metrics.py`, `frontend-web/tests/chat-shell.contract.test.tsx`, `frontend-web/tests/chat-shell.ui.test.tsx`, `frontend-web/tests/backend-proxy.contract.test.ts`, `make quality` |
| KI-2026-02-25-C17 | 2026-02-25 | Cloudflare cutover stabilized after custom-domain propagation lag: frontend `workers.dev` route re-enabled, frontend upstream moved to Cloudflare backend domain, and end-to-end chat/case-search smoke checks passed on both `workers.dev` and custom-domain paths. | `frontend-web/wrangler.jsonc`, frontend deploy version `d2cce7e8-094e-489d-b54b-10af2b620e87`, backend proxy deploy version `2ef750a9-ae2c-431c-837c-7425fc60063b`, smoke checks on `https://immcad-frontend-web.optivoo-edu.workers.dev`, `https://immcad.arkiteto.dpdns.org` (resolver override), and `https://immcad-api.arkiteto.dpdns.org` |
| KI-2026-02-25-C16 | 2026-02-25 | Cloudflare Python Worker backend compatibility baseline hardened: rate-limit client identification now supports Cloudflare headers, fallback host identification when `request.client` is unavailable, async endpoint signatures applied across API/health routes, and Redis rate limiting is now explicit opt-in. | `src/immcad_api/main.py`, `backend-vercel/src/immcad_api/main.py`, `src/immcad_api/api/routes/chat.py`, `backend-vercel/src/immcad_api/api/routes/chat.py`, `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `src/immcad_api/settings.py`, `backend-vercel/src/immcad_api/settings.py`, `tests/test_api_scaffold.py`, `tests/test_settings.py`, `uv run pytest -q tests/test_settings.py tests/test_api_scaffold.py tests/test_rate_limiters.py`, `make backend-vercel-sync-validate` |
| KI-2026-02-25-C15 | 2026-02-25 | Cloudflare migration bootstrap added for production-safe rollout: frontend deploy workflow enforced by tests, backend transitional proxy deploy workflow added, and backend migration scaffold/checks created. | `.github/workflows/cloudflare-frontend-deploy.yml`, `.github/workflows/cloudflare-backend-proxy-deploy.yml`, `backend-cloudflare/README.md`, `backend-cloudflare/src/worker.ts`, `backend-cloudflare/wrangler.backend-proxy.jsonc`, `backend-cloudflare/Dockerfile`, `tests/test_cloudflare_frontend_deploy_workflow.py`, `tests/test_cloudflare_backend_proxy_deploy_workflow.py`, `tests/test_cloudflare_backend_migration_artifacts.py` |
| KI-2026-02-25-C14 | 2026-02-25 | Case-search UX now surfaces actionable broad-query validation guidance instead of generic temporary-unavailable copy. | `frontend-web/components/chat/chat-shell-container.tsx`, `frontend-web/tests/chat-shell.contract.test.tsx`, `frontend-web/tests/fixtures/chat-contract-fixtures.ts` |
| KI-2026-02-25-C13 | 2026-02-25 | Provider prompt guardrails hardened to reduce model/vendor identity drift and force grounded citation context in Gemini/OpenAI request prompts. | `src/immcad_api/providers/gemini_provider.py`, `src/immcad_api/providers/openai_provider.py`, `backend-vercel/src/immcad_api/providers/gemini_provider.py`, `backend-vercel/src/immcad_api/providers/openai_provider.py`, `tests/test_gemini_provider.py`, `tests/test_openai_provider.py` |
| KI-2026-02-25-C12 | 2026-02-25 | Frontend proxy no longer enables chat scaffold fallback implicitly; fallback now requires explicit server opt-in and remains disabled in hardened environments. | `frontend-web/lib/backend-proxy.ts`, `frontend-web/tests/backend-proxy.contract.test.ts` |
| KI-2026-02-25-C11 | 2026-02-25 | Export security parity enforced: signed approval tokens are now required for `POST /api/export/cases` in all environments, removing non-hardened bypass. | `src/immcad_api/main.py`, `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/main.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `tests/test_export_policy_gate.py` |
| KI-2026-02-25-C10 | 2026-02-25 | Production-safe defaults hardened: `CASE_SEARCH_OFFICIAL_ONLY_RESULTS` now defaults to hardened `true` and is enforced in hardened environments. | `src/immcad_api/settings.py`, `backend-vercel/src/immcad_api/settings.py`, `tests/test_settings.py`, `src/immcad_api/README.md`, `backend-vercel/src/immcad_api/README.md` |
| KI-2026-02-25-C09 | 2026-02-25 | Case-search relevance tightened: broad/noise stopword queries are rejected with structured validation error and no longer return unrelated “latest” cases. | `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `src/immcad_api/sources/official_case_law_client.py`, `tests/test_api_scaffold.py`, `tests/test_official_case_law_client.py` |
| KI-2026-02-25-C08 | 2026-02-25 | CanLII ranking fallback hardened to avoid returning unranked arbitrary results when query terms do not match. | `src/immcad_api/sources/canlii_client.py`, `backend-vercel/src/immcad_api/sources/canlii_client.py`, `tests/test_canlii_client.py` |
| KI-2026-02-25-C07 | 2026-02-25 | `mypy` quality coverage expanded from 2 files to 17 production-critical files and is now enforced in both quality/release CI workflows, with regression tests guarding the workflow contract. | `pyproject.toml`, `.github/workflows/quality-gates.yml`, `.github/workflows/release-gates.yml`, `tests/test_quality_gates_workflow.py`, `tests/test_release_gates_workflow.py`, `src/immcad_api/services/chat_service.py`, `src/immcad_api/policy/compliance.py`, `backend-vercel/src/immcad_api/services/chat_service.py`, `backend-vercel/src/immcad_api/policy/compliance.py`, `./scripts/venv_exec.sh mypy`, `./scripts/venv_exec.sh pytest -q tests/test_quality_gates_workflow.py tests/test_release_gates_workflow.py`, `make quality` |
| KI-2026-02-25-C06 | 2026-02-25 | Frontend CI determinism hardened: workflow order now enforces `build -> typecheck -> test`, with regression tests to prevent drift. | `.github/workflows/quality-gates.yml`, `.github/workflows/release-gates.yml`, `tests/test_quality_gates_workflow.py`, `tests/test_release_gates_workflow.py`, `./scripts/venv_exec.sh pytest -q tests/test_quality_gates_workflow.py tests/test_release_gates_workflow.py tests/test_ops_alerts_workflow.py` |
| KI-2026-02-25-C05 | 2026-02-25 | Backend mirror drift resolved; backend-vercel runtime was synchronized with primary runtime and parity gate restored. | `rsync -a --exclude '__pycache__/' --exclude '*.pyc' src/immcad_api/ backend-vercel/src/immcad_api/`, `make backend-vercel-sync-validate`, `make quality` |
| KI-2026-02-25-C04 | 2026-02-25 | Case export approval in hardened environments now requires server-issued signed approval tokens (`/api/export/cases/approval`) before `/api/export/cases` download. Frontend now performs explicit approval handshake before export. | `src/immcad_api/api/routes/cases.py`, `src/immcad_api/schemas.py`, `src/immcad_api/main.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/schemas.py`, `backend-vercel/src/immcad_api/main.py`, `frontend-web/lib/api-client.ts`, `frontend-web/components/chat/chat-shell-container.tsx`, `tests/test_export_policy_gate.py`, `frontend-web/tests/chat-shell.contract.test.tsx`, `frontend-web/tests/api-client.contract.test.ts` |
| KI-2026-02-25-C03 | 2026-02-25 | Backend deploy configuration now follows Vercel-documented Python pinning and blocks local prebuilt/env leakage in deploy context. | `backend-vercel/.python-version`, `backend-vercel/.vercelignore`, `backend-vercel/vercel.json`, `scripts/check_repository_hygiene.sh`, `tests/test_backend_vercel_deploy_config.py`, `tests/test_repository_hygiene_script.py` |
| KI-2026-02-25-C01 | 2026-02-25 | Hardened environment aliases now consistently treated as hardened in backend and frontend runtime logic. | `src/immcad_api/settings.py`, `src/immcad_api/main.py`, `frontend-web/lib/server-runtime-config.ts`, `frontend-web/tests/server-runtime-config.contract.test.ts`, `tests/test_api_scaffold.py` |
| KI-2026-02-25-C02 | 2026-02-25 | Export URL host validation now permits official `www.*` subdomains while still blocking lookalike domains. | `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `tests/test_export_policy_gate.py` |

## Triage Rules

1. Every new production-impacting issue must receive an ID, severity, owner, and target date.
2. P0 issues block release sign-off until closed or explicitly accepted by engineering leadership.
3. Closed issues must link to concrete evidence (file paths, tests, or deployment IDs).
