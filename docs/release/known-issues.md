# Known Issues Register

Last updated: 2026-02-25
Owner: platform-engineering

Use this file as the canonical issue tracker when GitHub Issues are disabled for the repository.

## Open Issues

| ID | Severity | Area | Summary | Owner | Target |
|---|---|---|---|---|---|
| KI-2026-02-25-01 | P0 | platform-migration | Frontend has Cloudflare deploy workflow and build parity, but backend is still on transitional origin path (Cloudflare proxy -> legacy backend origin). Full Cloudflare-native backend runtime (Containers or Python Worker) and canary validation are still required before migration completion. | platform | Immediate |
| KI-2026-02-25-04 | P1 | operations | Repository-level issue tracking is disabled in GitHub, increasing risk that production defects are not centrally triaged unless this register is actively maintained. | eng-ops | Immediate |
| KI-2026-02-25-05 | P2 | process-control | Release verification is being executed in a dirty worktree with parallel in-flight edits; evidence capture is scoped, but final release cut must isolate readiness-only deltas before merge/deploy approval. | platform | Before next deploy window |
| KI-2026-02-25-07 | P1 | backend-runtime | Python Workers compatibility baseline is in place, but heavy backend internals still execute synchronous I/O paths; before full Cloudflare-native production cutover we need load-tested performance validation and, if required, async refactors for hot paths. | platform | Before Phase 3 cutover |
| KI-2026-02-25-06 | P1 | documentation | Release and operational runbooks still contain legacy Vercel-first command paths. Cloudflare-first deploy/runbook updates must be completed to avoid operator confusion during incident response. | platform | Immediate |

## Recently Closed

| ID | Closed Date | Summary | Evidence |
|---|---|---|---|
| KI-2026-02-25-C16 | 2026-02-25 | Cloudflare Python Worker backend compatibility baseline hardened: rate-limit client identification now supports Cloudflare headers, fallback host identification when `request.client` is unavailable, async endpoint signatures applied across API/health routes, and Redis rate limiting is now explicit opt-in. | `src/immcad_api/main.py`, `backend-vercel/src/immcad_api/main.py`, `src/immcad_api/api/routes/chat.py`, `backend-vercel/src/immcad_api/api/routes/chat.py`, `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `src/immcad_api/settings.py`, `backend-vercel/src/immcad_api/settings.py`, `tests/test_api_scaffold.py`, `tests/test_settings.py`, `uv run pytest -q tests/test_settings.py tests/test_api_scaffold.py tests/test_rate_limiters.py`, `make backend-vercel-sync-validate` |
| KI-2026-02-25-C15 | 2026-02-25 | Cloudflare migration bootstrap added for production-safe rollout: frontend deploy workflow enforced by tests, backend transitional proxy deploy workflow added, and backend migration scaffold/checks created. | `.github/workflows/cloudflare-frontend-deploy.yml`, `.github/workflows/cloudflare-backend-proxy-deploy.yml`, `backend-cloudflare/README.md`, `backend-cloudflare/src/worker.ts`, `backend-cloudflare/wrangler.backend-proxy.jsonc`, `backend-cloudflare/Dockerfile`, `tests/test_cloudflare_frontend_deploy_workflow.py`, `tests/test_cloudflare_backend_proxy_deploy_workflow.py`, `tests/test_cloudflare_backend_migration_artifacts.py` |
| KI-2026-02-25-C14 | 2026-02-25 | Case-search UX now surfaces actionable broad-query validation guidance instead of generic temporary-unavailable copy. | `frontend-web/components/chat/chat-shell-container.tsx`, `frontend-web/tests/chat-shell.contract.test.tsx`, `frontend-web/tests/fixtures/chat-contract-fixtures.ts` |
| KI-2026-02-25-C13 | 2026-02-25 | Provider prompt guardrails hardened to reduce model/vendor identity drift and force grounded citation context in Gemini/OpenAI request prompts. | `src/immcad_api/providers/gemini_provider.py`, `src/immcad_api/providers/openai_provider.py`, `backend-vercel/src/immcad_api/providers/gemini_provider.py`, `backend-vercel/src/immcad_api/providers/openai_provider.py`, `tests/test_gemini_provider.py`, `tests/test_openai_provider.py` |
| KI-2026-02-25-C12 | 2026-02-25 | Frontend proxy no longer enables chat scaffold fallback implicitly; fallback now requires explicit server opt-in and remains disabled in hardened environments. | `frontend-web/lib/backend-proxy.ts`, `frontend-web/tests/backend-proxy.contract.test.ts` |
| KI-2026-02-25-C11 | 2026-02-25 | Export security parity enforced: signed approval tokens are now required for `POST /api/export/cases` in all environments, removing non-hardened bypass. | `src/immcad_api/main.py`, `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/main.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `tests/test_export_policy_gate.py` |
| KI-2026-02-25-C10 | 2026-02-25 | Production-safe defaults hardened: `CASE_SEARCH_OFFICIAL_ONLY_RESULTS` now defaults to hardened `true` and is enforced in hardened environments. | `src/immcad_api/settings.py`, `backend-vercel/src/immcad_api/settings.py`, `tests/test_settings.py`, `src/immcad_api/README.md`, `backend-vercel/src/immcad_api/README.md` |
| KI-2026-02-25-C09 | 2026-02-25 | Case-search relevance tightened: broad/noise stopword queries are rejected with structured validation error and no longer return unrelated “latest” cases. | `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `src/immcad_api/sources/official_case_law_client.py`, `tests/test_api_scaffold.py`, `tests/test_official_case_law_client.py` |
| KI-2026-02-25-C08 | 2026-02-25 | CanLII ranking fallback hardened to avoid returning unranked arbitrary results when query terms do not match. | `src/immcad_api/sources/canlii_client.py`, `backend-vercel/src/immcad_api/sources/canlii_client.py`, `tests/test_canlii_client.py` |
| KI-2026-02-25-C07 | 2026-02-25 | `mypy` quality coverage expanded from 2 files to 17 production-critical files and is now enforced in both quality/release CI workflows, with regression tests guarding the workflow contract. | `pyproject.toml`, `.github/workflows/quality-gates.yml`, `.github/workflows/release-gates.yml`, `tests/test_quality_gates_workflow.py`, `tests/test_release_gates_workflow.py`, `src/immcad_api/services/chat_service.py`, `src/immcad_api/policy/compliance.py`, `backend-vercel/src/immcad_api/services/chat_service.py`, `backend-vercel/src/immcad_api/policy/compliance.py`, `./scripts/venv_exec.sh mypy`, `./scripts/venv_exec.sh pytest -q tests/test_quality_gates_workflow.py tests/test_release_gates_workflow.py`, `make quality` |
| KI-2026-02-25-C06 | 2026-02-25 | Frontend CI determinism hardened: workflow order now enforces `build -> typecheck -> test`, with regression tests to prevent drift. | `.github/workflows/quality-gates.yml`, `.github/workflows/release-gates.yml`, `tests/test_quality_gates_workflow.py`, `tests/test_release_gates_workflow.py`, `./scripts/venv_exec.sh pytest -q tests/test_quality_gates_workflow.py tests/test_release_gates_workflow.py tests/test_ops_alerts_workflow.py` |
| KI-2026-02-25-C05 | 2026-02-25 | Backend mirror drift resolved; backend-vercel runtime was synchronized with primary runtime and parity gate restored. | `rsync -a --exclude '__pycache__/' --exclude '*.pyc' src/immcad_api/ backend-vercel/src/immcad_api/`, `make backend-vercel-sync-validate`, `make quality` |
| KI-2026-02-25-C04 | 2026-02-25 | Case export approval in hardened environments now requires server-issued signed approval tokens (`/api/export/cases/approval`) before `/api/export/cases` download. Frontend now performs explicit approval handshake before export. | `src/immcad_api/api/routes/cases.py`, `src/immcad_api/schemas.py`, `src/immcad_api/main.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/schemas.py`, `backend-vercel/src/immcad_api/main.py`, `frontend-web/lib/api-client.ts`, `frontend-web/components/chat/chat-shell-container.tsx`, `tests/test_export_policy_gate.py`, `frontend-web/tests/chat-shell.contract.test.tsx`, `frontend-web/tests/api-client.contract.test.ts` |
| KI-2026-02-25-C03 | 2026-02-25 | Backend deploy configuration now follows Vercel-documented Python pinning and blocks local prebuilt/env leakage in deploy context. | `backend-vercel/.python-version`, `backend-vercel/.vercelignore`, `backend-vercel/vercel.json`, `scripts/check_repository_hygiene.sh`, `tests/test_backend_vercel_deploy_config.py`, `tests/test_repository_hygiene_script.py` |
| KI-2026-02-25-C01 | 2026-02-25 | Hardened environment aliases now consistently treated as hardened in backend and frontend runtime logic. | `src/immcad_api/settings.py`, `src/immcad_api/main.py`, `frontend-web/lib/server-runtime-config.ts`, `frontend-web/tests/server-runtime-config.contract.test.ts`, `tests/test_api_scaffold.py` |
| KI-2026-02-25-C02 | 2026-02-25 | Export URL host validation now permits official `www.*` subdomains while still blocking lookalike domains. | `src/immcad_api/api/routes/cases.py`, `backend-vercel/src/immcad_api/api/routes/cases.py`, `tests/test_export_policy_gate.py` |

## Triage Rules

1. Every new production-impacting issue must receive an ID, severity, owner, and target date.
2. P0 issues block release sign-off until closed or explicitly accepted by engineering leadership.
3. Closed issues must link to concrete evidence (file paths, tests, or deployment IDs).
